(this.webpackJsonpdiagraming=this.webpackJsonpdiagraming||[]).push([[0],[,,,,,,,,function(t,e,i){},,function(t,e,i){t.exports=i(17)},,,,,function(t,e,i){},function(t,e,i){},function(t,e,i){"use strict";i.r(e);var n=i(1),a=i.n(n),o=i(9),r=i.n(o),c=(i(15),i(2)),h=i(0),y=i(3),s=i(4),p=i(6),l=i(5),d=(i(16),i(8),function(t){Object(p.a)(i,t);var e=Object(l.a)(i);function i(){var t;Object(y.a)(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).dragging=!1,t.initialX=0,t.initialY=0,t.handleContextMenu=function(e){var i=t.props;(0,i.onRightClick)(i.widget.id,e)},t.handleDragStart=function(e){var i=t.props;(0,i.onDragStart)(i.widget.id,e)},t}return Object(s.a)(i,[{key:"render",value:function(){var t=this.props,e=t.cursor,i=t.selected,n=t.widget,o=n.x,r=n.y,c=n.width,h=n.height;return a.a.createElement("div",{onContextMenu:this.handleContextMenu,onMouseDown:this.handleDragStart,style:{top:r,left:o,width:c,height:h,cursor:"crosshair"===e?"crosshair":"pointer",border:i?"2px solid blue":"none"},className:"Sticky"})}}]),i}(a.a.Component)),x=i(19),g=function(t){return{id:x.a(),height:100,width:100,type:"sticky",x:(t.x||0)-50,y:(t.y||0)-50}},u=function(t){return{id:x.a(),height:0,width:0,type:"arrow",x:(t.x||0)-25,y:(t.y||0)-25,start:t.start||null,end:t.end||null,points:[],arrowType:"initial",chartBranchSide:null,chartBranchPosition:null}},w=function(t){Object(p.a)(i,t);var e=Object(l.a)(i);function i(){return Object(y.a)(this,i),e.apply(this,arguments)}return Object(s.a)(i,[{key:"render",value:function(){return a.a.createElement("svg",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},xmlns:"http://www.w3.org/2000/svg",version:"1.1"},function(t,e,i){var n=t[0],o=t[1],r="right"===n.type||"left"===n.type;if(r&&n.y===o.y||!r&&n.x===o.x){var c="M ".concat(n.x," ").concat(n.y," L ").concat(o.x," ").concat(o.y);return[a.a.createElement("path",{d:c,stroke:"red",strokeWidth:"2",fill:"none"}),a.a.createElement("circle",{cx:"".concat(o.x),cy:"".concat(o.y),r:"5",stroke:"#5cb85c",fill:"#5cb85c"})]}var h=r?(o.x-n.x)/2:(o.y-n.y)/2,y=r?n.x+h:n.y+h;e&&i&&e===n.type&&(y=i);var s="".concat(n.x," ").concat(n.y),p=r?"".concat(y," ").concat(n.y):" ".concat(n.x," ").concat(y),l=r?"".concat(y," ").concat(o.y):" ".concat(o.x," ").concat(y),d="".concat(o.x," ").concat(o.y),x="M ".concat(s," L ").concat(p),g="M ".concat(p," L ").concat(l),u="M ".concat(l," L ").concat(d);return[a.a.createElement("path",{d:x,stroke:"red",strokeWidth:"2",fill:"none"}),a.a.createElement("path",{d:g,stroke:"red",strokeWidth:"2",fill:"none"}),a.a.createElement("path",{d:u,stroke:"red",strokeWidth:"2",fill:"none"}),a.a.createElement("circle",{cx:"".concat(o.x),cy:"".concat(o.y),r:"5",stroke:"#5cb85c",fill:"#5cb85c"})]}(this.props.widget.points,this.props.widget.chartBranchSide,this.props.widget.chartBranchPosition))}}]),i}(a.a.PureComponent),f=function(t){Object(p.a)(i,t);var e=Object(l.a)(i);function i(){var t;Object(y.a)(this,i);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))).ref=null,t.state={cursor:"auto",dragging:null,initialId:null,initialX:null,initialY:null,lastX:null,lastY:null,selected:null,widgets:{}},t.handleRightClick=function(e){e.preventDefault(),e.stopPropagation(),t.state.initialId&&t.cancelArrowCreation()},t.handleStickyRightClick=function(e,i){i.preventDefault(),i.stopPropagation(),t.state.initialId?t.state.initialId!==e?t.setState((function(i){var n=i.widgets[i.initialId||""],a=i.widgets[e],o=[],r=Object(h.a)(Object(h.a)({},u({start:i.initialId,end:e})),{},{points:o}),y=Math.abs((n.x-a.x)/(n.y-a.y));return n.x+n.width+10<a.x?y>1?(o[0]={x:n.x+n.width,y:n.y+n.height/2,type:"right"},o[1]={x:a.x,y:a.y+a.height/2,type:"left"}):n.y+n.height+10<a.y?(o[0]={x:n.x+n.width/2,y:n.y+n.height,type:"bottom"},o[1]={x:a.x+a.width/2,y:a.y,type:"top"}):(o[0]={x:n.x+n.width/2,y:n.y,type:"top"},o[1]={x:a.x+a.width/2,y:a.y+a.height,type:"bottom"}):y>1?(o[0]={x:n.x,y:n.y+n.height/2,type:"left"},o[1]={x:a.x+a.width,y:a.y+a.height/2,type:"right"}):n.y+n.height+10<a.y?(o[0]={x:n.x+n.width/2,y:n.y+n.height,type:"bottom"},o[1]={x:a.x+a.width/2,y:a.y,type:"top"}):(o[0]={x:n.x+n.width/2,y:n.y,type:"top"},o[1]={x:a.x+a.width/2,y:a.y+a.height,type:"bottom"}),t.updateArrowChartBranch(r,i.widgets,!0),Object(h.a)(Object(h.a)({},i),{},{cursor:"auto",initialId:null,widgets:Object(h.a)(Object(h.a)({},i.widgets),{},Object(c.a)({},r.id,r))})})):t.cancelArrowCreation():t.setState({initialId:e,cursor:"crosshair"})},t.handleDoubleClick=function(e){var i=g({x:e.clientX,y:e.clientY});t.setState((function(t){return{selected:i.id,widgets:Object(h.a)(Object(h.a)({},t.widgets),{},Object(c.a)({},i.id,i))}}))},t.handleDrag=function(e){var i=e.clientX,n=e.clientY;t.setState((function(e){if(!e.dragging||!e.lastX||!e.lastY)return Object(h.a)({},e);var a=Object(h.a)({},e.widgets[e.dragging]);a.x=a.x+i-e.lastX,a.y=a.y+n-e.lastY;var o=Object.values(e.widgets).filter((function(t){return"arrow"===t.type&&(t.start===e.dragging||t.end===e.dragging)})).reduce((function(i,n){var o=n;return t.updateArrow(o,e.widgets,e.dragging,a),t.updateArrowChartBranch(o,e.widgets,!0),Object(h.a)(Object(h.a)({},i),{},Object(c.a)({},o.id,Object(h.a)({},o)))}),{});return{lastX:i,lastY:n,widgets:Object(h.a)(Object(h.a)({},e.widgets),{},Object(c.a)({},a.id,a),o)}}))},t.handleDragStart=function(e,i){var n=i.clientX,a=i.clientY;i.stopPropagation(),0===i.button&&t.setState({dragging:e,selected:e,initialX:n,initialY:a,lastX:n,lastY:a})},t.handleKeyDown=function(e){"Backspace"!==e.key&&"Delete"!==e.key||!t.state.selected||t.setState((function(t){var e=t.selected||"",i=t.widgets;return delete i[e],Object.values(i).forEach((function(t){"arrow"!==t.type||t.start!==e&&t.end!==e||delete i[t.id]})),Object(h.a)(Object(h.a)({},t),{},{selected:null,widgets:Object(h.a)({},i)})}))},t.handleMouseDown=function(){t.setState({selected:null})},t.handleMouseUp=function(e){t.setState((function(e){if(!e.dragging)return Object(h.a)({},e);var i=Object.values(e.widgets).filter((function(t){return"arrow"===t.type&&(t.start===e.dragging||t.end===e.dragging)})).map((function(t){return t})).reduce((function(i,n){return n.end===e.dragging&&t.updateArrowChartBranch(n,e.widgets,!1),Object(h.a)(Object(h.a)({},i),{},Object(c.a)({},n.id,Object(h.a)({},n)))}),{});return{dragging:null,widgets:Object(h.a)(Object(h.a)({},e.widgets),i)}}))},t.handleRef=function(e){return t.ref=e},t}return Object(s.a)(i,[{key:"cancelArrowCreation",value:function(){this.setState({initialId:null,cursor:"auto"})}},{key:"updateArrowChartBranch",value:function(t,e,i){if("chartSide"!==t.arrowType&&(!t.chartBranchSide||t.chartBranchSide!==t.points[0].type)){var n=Object.values(e).filter((function(e){return"arrow"===e.type&&e.start===t.start})).map((function(t){return t})).find((function(e){return e!==t&&"chartBranch"===e.arrowType&&e.points[0].type===t.points[0].type&&e.chartBranchPosition}));if(i&&!n)return;console.log("updateArrowChartBranch originType: ".concat(t.points[0].type," chartBranchArrow: ").concat(n,"  chartBranchPosition: ").concat(null===n||void 0===n?void 0:n.chartBranchPosition)),t.arrowType="chartBranch",t.chartBranchSide=t.points[0].type,n?t.chartBranchPosition=n.chartBranchPosition:"left"===t.points[0].type||"right"===t.points[0].type?t.chartBranchPosition=t.points[0].x+(t.points[1].x-t.points[0].x)/2:t.chartBranchPosition=t.points[0].y+(t.points[1].y-t.points[0].y)/2}}},{key:"updateArrow",value:function(t,e,i,n){var a=t.points[0],o=t.points[1];if(t.end===i){var r=e[t.start||""];"right"===a.type&&(a.x+10<o.x?t.points[1]={type:"left",x:n.x,y:n.y+n.height/2}:a.y+10<o.y?(t.points[0]={type:"bottom",x:r.x+r.width/2,y:r.y+r.height},t.points[1]={type:"top",x:n.x+n.width/2,y:n.y}):(t.points[0]={type:"top",x:r.x+r.width/2,y:r.y},t.points[1]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height})),"left"===a.type&&(a.x-10<o.x?t.points[1]={type:"right",x:n.x+n.width,y:n.y+n.height/2}:a.y+10<o.y?(t.points[0]={type:"bottom",x:r.x+r.width/2,y:r.y+r.height},t.points[1]={type:"top",x:n.x+n.width/2,y:n.y}):(t.points[0]={type:"top",x:r.x+r.width/2,y:r.y},t.points[1]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height})),"bottom"===a.type&&(a.y+10<o.y?t.points[1]={type:"top",x:n.x+n.width/2,y:n.y}:a.x+10<o.x?(t.points[0]={type:"right",x:r.x+r.width,y:r.y+r.height/2},t.points[1]={type:"left",x:n.x,y:n.y+n.height/2}):(t.points[0]={type:"left",x:r.x,y:r.y+r.width/2},t.points[1]={type:"right",x:n.x+n.width,y:n.y+n.height/2})),"top"===a.type&&(a.y-10>o.y?t.points[1]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height}:a.x+10<o.x?(t.points[0]={type:"right",x:r.x+r.width,y:r.y+r.height/2},t.points[1]={type:"left",x:n.x,y:n.y+n.height/2}):(t.points[0]={type:"left",x:r.x,y:r.y+r.width/2},t.points[1]={type:"right",x:n.x+n.width,y:n.y+n.height/2}))}if(t.start===i){var c=e[t.end||""];"right"===a.type&&(a.x+10<o.x?t.points[0]={type:"right",x:n.x+n.width,y:n.y+n.height/2}:a.y+10<o.y?(t.points[0]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height},t.points[1]={type:"top",x:c.x+c.width/2,y:c.y}):(t.points[0]={type:"top",x:n.x+n.width/2,y:n.y},t.points[1]={type:"bottom",x:c.x+c.width/2,y:c.y+c.height})),"left"===a.type&&(a.x-10>o.x?t.points[0]={type:"left",x:n.x,y:n.y+n.height/2}:a.y+10<o.y?(t.points[0]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height},t.points[1]={type:"top",x:c.x+c.width/2,y:c.y}):(t.points[0]={type:"top",x:n.x+n.width/2,y:n.y},t.points[1]={type:"bottom",x:c.x+c.width/2,y:c.y+c.height})),"bottom"===a.type&&(a.y+10<o.y?t.points[0]={type:"bottom",x:n.x+n.width/2,y:n.y+n.height}:a.x+10<o.x?(t.points[0]={type:"right",x:n.x+n.width,y:n.y+n.height/2},t.points[1]={type:"left",x:c.x,y:c.y+c.height/2}):(t.points[0]={type:"left",x:n.x,y:n.y+n.width/2},t.points[1]={type:"right",x:c.x+c.width,y:c.y+c.height/2})),"top"===a.type&&(a.y-10>o.y?t.points[0]={type:"top",x:n.x+n.width/2,y:n.y}:a.x+10<o.x?(t.points[0]={type:"right",x:n.x+n.width,y:n.y+n.height/2},t.points[1]={type:"left",x:c.x,y:c.y+c.height/2}):(t.points[0]={type:"left",x:n.x,y:n.y+n.width/2},t.points[1]={type:"right",x:c.x+c.width,y:c.y+c.height/2}))}}},{key:"render",value:function(){var t=this,e=this.state,i=e.cursor,n=e.selected,o=e.widgets;return a.a.createElement("div",{style:{cursor:i},className:"App",tabIndex:1,onContextMenu:this.handleRightClick,onDoubleClick:this.handleDoubleClick,onKeyDown:this.handleKeyDown,onMouseMove:this.handleDrag,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,ref:this.handleRef},Object.values(o).map((function(e){return"sticky"===e.type?a.a.createElement(d,{cursor:i,onRightClick:t.handleStickyRightClick,onDragStart:t.handleDragStart,selected:n===e.id,widget:e,key:e.id}):"arrow"===e.type?a.a.createElement(w,{widget:e,key:e.id}):null})))}}]),i}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(f,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[10,1,2]]]);
//# sourceMappingURL=main.26023d55.chunk.js.map