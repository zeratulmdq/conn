(this.webpackJsonpdiagraming=this.webpackJsonpdiagraming||[]).push([[0],[,,,,,,,,function(t,e,n){},,,function(t,e,n){t.exports=n(19)},,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var a=n(1),i=n.n(a),o=n(9),r=n.n(o),c=(n(16),n(10)),s=n(2),l=n(0),d=n(3),h=n(4),u=n(6),y=n(5),p=(n(17),n(8),function(t){Object(u.a)(n,t);var e=Object(y.a)(n);function n(){var t;Object(d.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).dragging=!1,t.initialX=0,t.initialY=0,t.handleDragStart=function(e){var n=t.props,a=n.onDragStart,i=n.widget,o=n.cursor,r=n.onMouseDown;"crosshair"===o?r(i.id,e):a(i.id,e)},t.handleMouseUp=function(e){var n=t.props,a=n.onMouseUp,i=n.cursor,o=n.widget;"crosshair"===i&&a(o.id,e)},t.handleMouseHover=function(e){var n=t.props;(0,n.onMouseHover)(n.widget.id,e)},t.handleMouseLeave=function(e){var n=t.props;(0,n.onMouseLeave)(n.widget.id,e)},t}return Object(h.a)(n,[{key:"render",value:function(){var t=this.props,e=t.cursor,n=t.selected,a=t.widget,o=a.x,r=a.y,c=a.width,s=a.height;return i.a.createElement("div",{onMouseUp:this.handleMouseUp,onMouseDown:this.handleDragStart,onMouseMove:this.handleMouseHover,onMouseLeave:this.handleMouseLeave,style:{top:r,left:o,width:c,height:s,cursor:"crosshair"===e?"crosshair":"pointer",border:n?"2px solid blue":"none"},className:"Sticky",id:"auto"},i.a.createElement("div",{className:"snapping-point top",style:{top:-15,left:c/2-15,width:30,height:30},id:"top"}),i.a.createElement("div",{className:"snapping-point right",style:{top:s/2-15,left:c-15,width:30,height:30},id:"right"}),i.a.createElement("div",{className:"snapping-point bottom",style:{top:s-15,left:c/2-15,width:30,height:30},id:"bottom"}),i.a.createElement("div",{className:"snapping-point left",style:{top:s/2-15,left:-15,width:30,height:30},id:"left"}),i.a.createElement("svg",{className:"auto-affordance"},i.a.createElement("circle",{cx:"".concat(c/2),cy:"".concat(s/2),r:"5",stroke:"#1c7ff9",fill:"none"})))}}]),n}(i.a.Component)),g=(n(18),function(t){Object(u.a)(n,t);var e=Object(y.a)(n);function n(){var t;Object(d.a)(this,n);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(t=e.call.apply(e,[this].concat(o))).state={direction:"other",pointerEventsEnabled:!1},t.setDirection=function(){var e=t.getPoints(),n=e.start,a=e.end,i="right"===n.type||"left"===n.type;i!==("right"===a.type||"left"===a.type)&&t.setState({direction:"other"}),t.setState({direction:i?"vertical":"horizontal"})},t.getPoints=function(){var e=t.props.widget.points;return{start:e[0],end:e[1]}},t.enablePointerEvents=function(){t.state.pointerEventsEnabled||(console.log("enable pointer events"),t.setState({pointerEventsEnabled:!0}))},t.disablePointerEvents=function(){t.state.pointerEventsEnabled&&(console.log("disable pointer events"),t.setState({pointerEventsEnabled:!1}))},t.connectionDot=function(e,n,a,o){return i.a.createElement("circle",{key:a,cx:"".concat(e),cy:"".concat(n),r:"5",stroke:o?"black":"#1c7ff9",fill:o?"white":"#1c7ff9",onMouseDown:function(e){var n=t.props;(0,n.onDragPointStart)(n.widget.id,e,!!o)}})},t.handleMouseMove=function(e){var n=e.clientX,a=e.clientY;if(t.setDirection(),t.state.pointerEventsEnabled&&"other"!==t.state.direction){var i=t.getPoints(),o=i.start,r=i.end;if("vertical"!==t.state.direction){var c=Math.min(o.y,r.y),s=Math.max(o.y,r.y);c<a-10&&s>a+10&&t.state.y!==a&&t.setState({y:a})}else{var l=Math.min(o.x,r.x),d=Math.max(o.x,r.x);l<n-10&&d>n+10&&t.state.x!==n&&t.setState({x:n})}}},t.pathGenerator=function(e,n,a,o,r){var c=e[0],s=e[1],l="right"===c.type||"left"===c.type,d="right"===s.type||"left"===s.type,h=l?(s.x-c.x)/2:(s.y-c.y)/2;if(l&&c.y===s.y||!l&&c.x===s.x){var u="M ".concat(c.x," ").concat(c.y," L ").concat(s.x," ").concat(s.y);return[t.connectionDot(c.x,c.y,"0",!0),i.a.createElement("path",{d:u,stroke:"black",strokeWidth:"2",fill:"none",key:"1"}),t.connectionDot(s.x,s.y,"2")]}if(l!==d){if(l?"bottom"===s.type&&s.y>c.y||"top"===s.type&&s.y<c.y:"right"===s.type&&s.x>c.x||"left"===s.type&&s.x<c.x){var y,p,g="".concat(c.x," ").concat(c.y),f=l?"".concat(c.x+h," ").concat(c.y):" ".concat(c.x," ").concat(c.y+h),v="".concat(s.x," ").concat(s.y);"bottom"===s.type||"right"===s.type?(y=l?"".concat(c.x+h," ").concat(s.y+20):" ".concat(s.x+20," ").concat(c.y+h),p=l?"".concat(s.x," ").concat(s.y+20):" ".concat(s.x+20," ").concat(s.y)):(y=l?"".concat(c.x+h," ").concat(s.y-20):" ".concat(s.x-20," ").concat(c.y+h),p=l?"".concat(s.x," ").concat(s.y-20):" ".concat(s.x-20," ").concat(s.y));var b="M ".concat(g," L ").concat(f),w="M ".concat(f," L ").concat(y),x="M ".concat(y," L ").concat(p),k="M ".concat(p," L ").concat(v);return[t.connectionDot(c.x,c.y,"0",!0),i.a.createElement("path",{d:b,stroke:"black",strokeWidth:"2",fill:"none",key:"1"}),i.a.createElement("path",{key:"2",d:w,stroke:"black",strokeWidth:"2",fill:"none"}),i.a.createElement("path",{d:x,stroke:"black",strokeWidth:"2",fill:"none",key:"3"}),i.a.createElement("path",{d:k,stroke:"black",strokeWidth:"2",fill:"none",key:"4"}),t.connectionDot(s.x,s.y,"5")]}var O="".concat(c.x," ").concat(c.y),m=l?"".concat(s.x," ").concat(c.y):"".concat(c.x," ").concat(s.y),j="".concat(s.x," ").concat(s.y),M="M ".concat(O," L ").concat(m),S="M ".concat(m," L ").concat(j);return[t.connectionDot(c.x,c.y,"0",!0),i.a.createElement("path",{d:M,stroke:"black",strokeWidth:"2",fill:"none",key:"1"}),i.a.createElement("path",{d:S,stroke:"black",strokeWidth:"2",fill:"none",key:"2"}),t.connectionDot(s.x,s.y,"3")]}if((l?"right"===s.type&&s.x>c.x||"left"===s.type&&s.x<c.x:"bottom"===s.type&&s.y>c.y||"top"===s.type&&s.y<c.y)&&!n){var E,D,P="".concat(c.x," ").concat(c.y),B="".concat(s.x," ").concat(s.y);"bottom"===s.type||"right"===s.type?(E=l?"".concat(s.x+20," ").concat(c.y):" ".concat(c.x," ").concat(s.y+20),D=l?"".concat(s.x+20," ").concat(s.y):" ".concat(s.x," ").concat(s.y+20)):(E=l?"".concat(s.x-20," ").concat(c.y):" ".concat(c.x," ").concat(s.y-20),D=l?"".concat(s.x-20," ").concat(s.y):" ".concat(s.x," ").concat(s.y-20));var C="M ".concat(P," L ").concat(E),I="M ".concat(E," L ").concat(D),W="M ".concat(D," L ").concat(B);return[t.connectionDot(c.x,c.y,"0",!0),i.a.createElement("path",{d:C,stroke:"black",strokeWidth:"2",fill:"none",key:"1"}),i.a.createElement("path",{key:"2",d:I,stroke:"black",strokeWidth:"2",fill:"none"}),i.a.createElement("path",{d:W,stroke:"black",strokeWidth:"2",fill:"none",key:"3"}),t.connectionDot(s.x,s.y,"4")]}var A=l&&o?o:!l&&r?r:l?c.x+h:c.y+h;if(n){var T="manyToOne"===n.type?s:c;n.convergenceSide===T.type&&(A=l&&o?o:!l&&r?r:n.position)}var L="".concat(c.x," ").concat(c.y),z=l?"".concat(A," ").concat(c.y):" ".concat(c.x," ").concat(A),H=l?"".concat(A," ").concat(s.y):" ".concat(s.x," ").concat(A),U="".concat(s.x," ").concat(s.y),N="M ".concat(L," L ").concat(z),X="M ".concat(z," L ").concat(H),Y="M ".concat(H," L ").concat(U),K=l?"ew-resize":"ns-resize";return[t.connectionDot(c.x,c.y,"0",!0),i.a.createElement("path",{d:N,stroke:"black",strokeWidth:"2",fill:"none",key:"1"}),i.a.createElement("path",{key:"2",d:X,stroke:"black",strokeWidth:"2",fill:"none",style:{cursor:K,pointerEvents:"auto"},onMouseDown:a}),i.a.createElement("path",{d:Y,stroke:"black",strokeWidth:"2",fill:"none",key:"3"}),t.connectionDot(s.x,s.y,"4")]},t}return Object(h.a)(n,[{key:"componentDidMount",value:function(){this.setDirection()}},{key:"componentDidUpdate",value:function(){var t=this.getPoints(),e=t.start,n=t.end;if(this.state.x&&"vertical"===this.state.direction){var a=this.state.x-e.x,i=this.state.x-n.x;(a>0&&i>0||a<0&&i<0)&&this.setState({x:void 0})}if(this.state.y&&"horizontal"===this.state.direction){var o=this.state.y-e.y,r=this.state.y-n.y;(o>0&&r>0||o<0&&r<0)&&this.setState({y:void 0})}}},{key:"render",value:function(){var t=this.pathGenerator(this.props.widget.points,this.props.widget.chartBranch,this.enablePointerEvents,this.state.x,this.state.y);return i.a.createElement("svg",{style:{position:"absolute",top:0,left:0,pointerEvents:this.state.pointerEventsEnabled?"auto":"none"},xmlns:"http://www.w3.org/2000/svg",version:"1.1",className:"Arrow",onMouseUp:this.disablePointerEvents,onMouseMove:this.handleMouseMove},t)}}]),n}(i.a.PureComponent)),f=function(t){Object(u.a)(n,t);var e=Object(y.a)(n);function n(){var t;Object(d.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).state={checked:!1},t.handleOnChange=function(e){t.setState((function(e){var n=!e.checked;return t.props.onCheckedChange(n),{checked:n}}))},t}return Object(h.a)(n,[{key:"render",value:function(){return i.a.createElement("div",{style:{height:"auto"}},i.a.createElement("label",null,i.a.createElement("input",{type:"checkbox",style:{width:15,height:15},onChange:this.handleOnChange,defaultChecked:this.state.checked}),this.props.label))}}]),n}(i.a.PureComponent),v=n(21),b=function(t){var e,n;return{id:v.a(),height:null!==(e=t.height)&&void 0!==e?e:100,width:null!==(n=t.width)&&void 0!==n?n:100,type:"sticky",x:(t.x||0)-50,y:(t.y||0)-50}},w=function(t){return{id:v.a(),height:0,width:0,type:"arrow",x:(t.x||0)-25,y:(t.y||0)-25,start:t.start||null,end:t.end||null,points:[],arrowType:t.arrowType||"initial",chartBranch:null,initialIsHorizontal:t.initialIsHorizontal||!0}},x=function(t){return"left"===t||"right"===t?"horizontal":"vertical"},k={position:"absolute",top:0,width:"auto",height:"auto",borderStyle:"solid",backgroundColor:"lightgray",padding:10},O=function(t){Object(u.a)(n,t);var e=Object(y.a)(n);function n(){var t;Object(d.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))).ref=null,t.state={settings:{stickToConvergentWidgetSide:!1},cursor:"auto",dragging:null,initialId:null,endId:null,selected:null,widgets:{}},t.mousePosition=null,t.mouseOverSticky=!1,t.handleArrowPointDragStart=function(e,n,a){if(a){var i=t.state.widgets[e].end;t.setState((function(t){return Object(l.a)(Object(l.a)({},t),{},{cursor:"crosshair",dragging:[e],endId:i,initialId:null,widgets:Object(l.a)(Object(l.a)({},t.widgets),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},t.widgets[e]),{},{start:null})))})}))}else{var o=t.state.widgets[e].start;t.setState((function(t){return Object(l.a)(Object(l.a)({},t),{},{cursor:"crosshair",dragging:[e],initialId:o,endId:null,widgets:Object(l.a)(Object(l.a)({},t.widgets),{},Object(s.a)({},e,Object(l.a)(Object(l.a)({},t.widgets[e]),{},{end:null})))})}))}},t.handleStickyMouseDown=function(e,n){if("crosshair"===t.state.cursor)if(t.state.dragging);else{var a={x:n.clientX,y:n.clientY};t.setState((function(n){var i=Object(l.a)({},w({start:e,end:null}));return t.updateDisconnectedArrow(i,n.widgets,a),Object(l.a)(Object(l.a)({},n),{},{initialId:e,widgets:Object(l.a)(Object(l.a)({},n.widgets),{},Object(s.a)({},i.id,i)),dragging:[i.id]})}))}},t.handleStickyMouseUp=function(e,n){t.state.initialId!==e&&t.state.endId!==e?"crosshair"===t.state.cursor&&t.setState((function(t){var n,a;if(!t.dragging)return Object(l.a)({},t);var i=Object(l.a)({},t.widgets[t.dragging[0]]),o=t.widgets[null!==(n=i.start)&&void 0!==n?n:e],r=t.widgets[null!==(a=i.end)&&void 0!==a?a:e];if(Object.values(t.widgets).find((function(t){return"arrow"===t.type&&t.id!==i.id&&t.start===o.id&&t.end===r.id})))return Object(l.a)({},t);var c=Math.abs((o.x-r.x)/(o.y-r.y))>1;return i.start=o.id,i.end=r.id,i.initialIsHorizontal=c,Object(l.a)(Object(l.a)({},t),{},{cursor:"auto",dragging:null,initialId:null,endId:null,widgets:Object(l.a)(Object(l.a)({},t.widgets),{},Object(s.a)({},i.id,i))})})):t.cancelArrowCreation()},t.handleDoubleClick=function(e){var n=e.ctrlKey?150:100,a=b({x:e.clientX,y:e.clientY,width:n});t.setState((function(t){return{selected:[a.id],widgets:Object(l.a)(Object(l.a)({},t.widgets),{},Object(s.a)({},a.id,a))}}))},t.handleDrag=function(e){var n=t.mousePosition?e.clientX-t.mousePosition.x:e.clientX,a=t.mousePosition?e.clientY-t.mousePosition.y:e.clientY;t.mousePosition={x:e.clientX,y:e.clientY};var i=t.state,o=i.dragging,r=i.widgets;if(o){var c=o.map((function(t){return r[t]}));if(c.length>1||"sticky"===c[0].type){var d=Object.values(r).filter((function(t){return"arrow"===t.type&&o&&(t.start&&o.includes(t.start)||t.end&&o.includes(t.end))})).reduce((function(e,i){var c=i;return t.updateArrow(c,r),o&&c.start&&o.includes(c.start)&&c.end&&o.includes(c.end)&&c.chartBranch&&"oneToOne"===c.chartBranch.type&&(c.chartBranch.position=c.chartBranch.position+(c.initialIsHorizontal?n:a)),Object(l.a)(Object(l.a)({},e),{},Object(s.a)({},c.id,Object(l.a)({},c)))}),{}),h=c.reduce((function(t,e){return Object(l.a)(Object(l.a)({},t),{},Object(s.a)({},e.id,Object(l.a)(Object(l.a)({},e),{},{x:e.x+n,y:e.y+a})))}),{});t.setState({widgets:Object(l.a)(Object(l.a)(Object(l.a)({},r),h),d)})}else if("arrow"===c[0].type&&!t.mouseOverSticky){var u=Object(l.a)({},c[0]);u.end&&u.start||t.updateDisconnectedArrow(u,r,t.mousePosition),t.setState({widgets:Object(l.a)(Object(l.a)({},r),{},Object(s.a)({},u.id,u))})}}},t.handleMouseHoverSticky=function(e,n){t.mouseOverSticky=!0;var a=n.target.id,i=t.state,o=i.dragging,r=i.widgets;if(o){var c=o.map((function(t){return r[t]}));if(1===c.length&&"arrow"===c[0].type){var d=!c[0].start,h=d?c[0].startPoint!==a&&c[0].start===e:c[0].endPoint!==a&&c[0].end===e;if(c[0].start!==e&&c[0].end!==e||h){var u,y,p=Object(l.a)({},c[0]);p.start=null!==(u=p.start)&&void 0!==u?u:e,p.end=null!==(y=p.end)&&void 0!==y?y:e,t.updateArrow(p,r,a,d);var g=Object(l.a)(Object(l.a)({},r),{},Object(s.a)({},p.id,p));t.setState({widgets:g})}}}},t.handleMouseLeaveSticky=function(e,n){t.mouseOverSticky=!1;var a=t.state,i=a.dragging,o=a.widgets;if(i){var r=i.map((function(t){return o[t]}));if(1===r.length&&"arrow"===r[0].type&&r[0].start&&r[0].end&&(r[0].start===e||r[0].end===e)){var c=Object(l.a)({},r[0]);c.start=c.start===e?null:c.start,c.end=c.end===e?null:c.end,t.updateDisconnectedArrow(c,o,{x:n.clientX,y:n.clientY}),t.setState({widgets:Object(l.a)(Object(l.a)({},o),{},Object(s.a)({},c.id,c))})}}},t.handleWidgetDragStart=function(e,n){var a=n.shiftKey;if(n.stopPropagation(),0===n.button&&!t.state.dragging){var i=t.state.selected&&(t.state.selected.includes(e)||a)?t.state.selected.includes(e)?t.state.selected:[].concat(Object(c.a)(t.state.selected),[e]):[e],o=t.state.selected&&t.state.selected.includes(e)?t.state.selected:[e];t.setState({dragging:o,selected:i})}},t.handleKeyDown=function(e){if("c"===e.key){var n="auto"===t.state.cursor?"crosshair":"auto";"auto"===n?t.cancelArrowCreation():t.setState({cursor:n})}"Backspace"!==e.key&&"Delete"!==e.key||!t.state.selected||t.setState((function(t){var e=t.selected||null,n=t.widgets;return null===e||void 0===e||e.forEach((function(t){Object.values(n).forEach((function(e){"arrow"!==e.type||e.start!==t&&e.end!==t||delete n[e.id]})),delete n[t]})),Object(l.a)(Object(l.a)({},t),{},{selected:null,widgets:Object(l.a)({},n)})}))},t.handleMouseDown=function(){t.setState({selected:null})},t.handleMouseUp=function(e){var n=t.state.dragging&&t.state.dragging.map((function(e){return t.state.widgets[e]}));if(n&&1===n.length&&"arrow"===n[0].type)return console.log("mouse up only dragging one arrow"),void((t.state.initialId||t.state.endId)&&t.cancelArrowCreation());t.setState((function(e){if(!e.dragging)return Object(l.a)({},e);var n=Object.values(e.widgets).filter((function(t){var n,a;return"arrow"===t.type&&(t.start&&(null===(n=e.dragging)||void 0===n?void 0:n.includes(t.start))||t.end&&(null===(a=e.dragging)||void 0===a?void 0:a.includes(t.end)))})).map((function(t){return t})).reduce((function(n,a){if(!e.settings.stickToConvergentWidgetSide||"chartBranch"!==a.arrowType){if(t.isChartSideArrow(a,e.widgets)){var i=e.widgets[a.start||""],o=e.widgets[a.end||""];t.updateArrowChartSide(a,i,o)&&(a.arrowType="chartSide")}t.setArrowChartBranch(a,e.widgets,!1)}return a.initialIsHorizontal="left"===a.points[0].type||"right"===a.points[0].type,Object(l.a)(Object(l.a)({},n),{},Object(s.a)({},a.id,Object(l.a)({},a)))}),{});return{dragging:null,widgets:Object(l.a)(Object(l.a)({},e.widgets),n)}}))},t.handleRef=function(e){t.ref=e,t.ref&&t.ref.focus()},t}return Object(h.a)(n,[{key:"cancelArrowCreation",value:function(){this.setState((function(t){if(t.dragging&&t.dragging.length){var e=Object(l.a)({},t.widgets[t.dragging[0]]);if("arrow"===e.type){var n=t.widgets;return delete n[e.id],Object(l.a)(Object(l.a)({},t),{},{dragging:null,initialId:null,endId:null,cursor:"auto",widgets:Object(l.a)({},n)})}}return Object(l.a)(Object(l.a)({},t),{},{dragging:null,initialId:null,endId:null,cursor:"auto"})}))}},{key:"setArrowChartBranch",value:function(t,e,n){if(!this.state.settings.stickToConvergentWidgetSide&&t.chartBranch&&("manyToOne"===t.chartBranch.type?t.points[1]:t.points[0]).type===t.chartBranch.convergenceSide)return;var a=this.getSharedChartBranchArrow(t,e);if(n&&!a||t.startPoint||t.endPoint)t.chartBranch=null;else if(n||(t.arrowType="chartBranch"),a&&a.chartBranch)"oneToOne"===a.chartBranch.type&&(a.start===t.start?(a.chartBranch.type="oneToMany",a.chartBranch.convergenceSide=t.points[0].type):(a.chartBranch.type="manyToOne",a.chartBranch.convergenceSide=t.points[1].type)),t.chartBranch=Object.assign({},a.chartBranch);else{console.log("new lonely charBranch arrow");var i={position:0,convergenceSide:t.points[0].type,type:"oneToOne"};"horizontal"===x(i.convergenceSide)?i.position=t.points[0].x+(t.points[1].x-t.points[0].x)/2:i.position=t.points[0].y+(t.points[1].y-t.points[0].y)/2,t.chartBranch=i}}},{key:"getSharedChartBranchArrow",value:function(t,e){var n=Object.values(e).filter((function(e){return"arrow"===e.type&&e.id!==t.id&&"chartBranch"===e.arrowType&&e.chartBranch&&(e.start===t.start&&e.points[0].type===t.points[0].type||e.end===t.end&&e.points[1].type===t.points[1].type)})).map((function(t){return t}));return n.length>0?n[0]:null}},{key:"updateDisconnectedArrow",value:function(t,e,n){var a=e[t.start||""],i=e[t.end||""],o=a||i,r=a?{x:a.x,y:a.y}:n,c=i?{x:i.x,y:i.y}:n,s=[{type:"right",x:0,y:0},{type:"left",x:1,y:0}];Math.abs((r.x-c.x)/(r.y-c.y))>1?o.x+o.width+10<n.x?(s[0].type=a?"right":"left",s[1].type=a?"left":"right"):(s[0].type=a?"left":"right",s[1].type=a?"right":"left"):o.y+o.height+10<n.y?(s[0].type=a?"bottom":"top",s[1].type=a?"top":"bottom"):(s[0].type=a?"top":"bottom",s[1].type=a?"bottom":"top"),s[0]=a?this.getWidgetSideMidPosition(s[0],a):Object(l.a)(Object(l.a)({},s[0]),{},{x:n.x,y:n.y}),s[1]=i?this.getWidgetSideMidPosition(s[1],i):Object(l.a)(Object(l.a)({},s[1]),{},{x:n.x,y:n.y}),t.points=s}},{key:"updateArrow",value:function(t,e,n,a){console.log("snappingPoint: ",n);var i=e[t.start||""],o=e[t.end||""],r=[{type:"right",x:0,y:0},{type:"left",x:1,y:0}];(2===t.points.length&&(r=t.points),this.state.settings.stickToConvergentWidgetSide&&"chartBranch"===t.arrowType)||(a&&n?t.startPoint="auto"!==n?n:null:n&&(t.endPoint="auto"!==n?n:null,t.arrowType="initial",t.chartBranch=null),Math.abs((i.x-o.x)/(i.y-o.y))>1?i.x+i.width+10<o.x?(r[0].type=t.startPoint||"right",r[1].type=t.endPoint||"left"):(r[0].type=t.startPoint||"left",r[1].type=t.endPoint||"right"):i.y+i.height+10<o.y?(r[0].type=t.startPoint||"bottom",r[1].type=t.endPoint||"top"):(r[0].type=t.startPoint||"top",r[1].type=t.endPoint||"bottom"),r[0]=this.getWidgetSideMidPosition(r[0],i),r[1]=this.getWidgetSideMidPosition(r[1],o),t.points=r,this.isChartSideArrow(t,e)&&this.updateArrowChartSide(t,i,o),this.setArrowChartBranch(t,e,!0));if(t.chartBranch){var c="manyToOne"===t.chartBranch.type,s=c?t.points[1]:t.points[0],l=c?t.points[0]:t.points[1],d=c?o:i,h=c?i:o;s=this.getWidgetSideMidPosition(s,d),l=this.getWidgetSideMidPosition(l,h),console.log(l),"horizontal"===x(t.chartBranch.convergenceSide)?t.chartBranch.position>=h.x&&t.chartBranch.position<=h.x+h.width?(l.x=t.chartBranch.position,l.y=h.y+h.height/2>s.y?h.y:h.y+h.height):(l.type=t.chartBranch.position<h.x?"left":"right",l=this.getWidgetSideMidPosition(l,h)):t.chartBranch.position>=h.y&&t.chartBranch.position<=h.y+h.height?(l.x=h.x+h.width/2>s.x?h.x:h.x+h.width,l.y=t.chartBranch.position):(l.type=t.chartBranch.position<h.y?"top":"bottom",l=this.getWidgetSideMidPosition(l,h)),t.points[0]=c?l:s,t.points[1]=c?s:l}}},{key:"isChartSideArrow",value:function(t,e){if(!this.getSharedChartBranchArrow(t,e))return t.initialIsHorizontal&&("top"===t.points[0].type||"bottom"===t.points[0].type)||!t.initialIsHorizontal&&("left"===t.points[0].type||"right"===t.points[0].type)}},{key:"updateArrowChartSide",value:function(t,e,n){if(t.initialIsHorizontal){var a=this.getIntersectionMiddle(e.x,e.width,n.x,n.width);if(a)return t.points[0].x=a,t.points[1].x=a,!0}else{var i=this.getIntersectionMiddle(e.y,e.height,n.y,n.height);if(i)return t.points[0].y=i,t.points[1].y=i,!0}t.initialIsHorizontal?t.points[0].type=n.x>e.x+e.width/2?"right":"left":t.points[0].type=n.y>e.y+e.height/2?"bottom":"top",t.points[0]=this.getWidgetSideMidPosition(t.points[0],e);var o=e.x+e.width/2,r=e.y+e.height/2,c=n.x+n.width/2,s=n.y+n.height/2,l=Math.abs(o-c)-(e.width/2+n.width/2),d=Math.abs(r-s)-(e.height/2+n.height/2);if(t.initialIsHorizontal?l<=10:d<=10)if(t.initialIsHorizontal){t.points[1].type=n.y>t.points[0].y?"top":"bottom";var h=e.width/2+Math.max(l+10,20);t.points[1].x=o+("right"===t.points[0].type?h:-h),t.points[1].y="top"===t.points[1].type?n.y:n.y+n.height}else{t.points[1].type=n.x>t.points[0].x?"left":"right";var u=e.height/2+Math.max(d+10,20);t.points[1].x="left"===t.points[1].type?n.x:n.x+n.width,t.points[1].y=r+("bottom"===t.points[0].type?u:-u)}else t.initialIsHorizontal?t.points[1].type="right"===t.points[0].type?"left":"right":t.points[1].type="bottom"===t.points[0].type?"top":"bottom",t.points[1]=this.getWidgetSideMidPosition(t.points[1],n);return!1}},{key:"widgetsTooClose",value:function(t,e,n,a){var i=t.x+t.width/2,o=t.y+t.height/2,r=e.x+e.width/2,c=e.y+e.height/2;return a?Math.abs(i-r)-(t.width/2+e.width/2)<=n:Math.abs(o-c)-(t.height/2+e.height/2)<=n}},{key:"getIntersectionMiddle",value:function(t,e,n,a){var i=t+e,o=n+a;if(t===n&&i===o||t>n&&t<o){var r=o-t;return r<=20?null:t+r/2}if(i>n&&i<o){var c=i-n;return c<=20?null:i-c/2}return null}},{key:"between",value:function(t,e,n){return t>e&&t<n}},{key:"getWidgetSideMidPosition",value:function(t,e){var n={type:t.type,x:0,y:0};switch(t.type){case"top":n.x=e.x+e.width/2,n.y=e.y;break;case"right":n.x=e.x+e.width,n.y=e.y+e.height/2;break;case"bottom":n.x=e.x+e.width/2,n.y=e.y+e.height;break;case"left":n.x=e.x,n.y=e.y+e.height/2}return n}},{key:"render",value:function(){var t=this,e=this.state,n=e.cursor,a=e.selected,o=e.widgets;return i.a.createElement("div",null,i.a.createElement("div",{id:"canvas",style:{cursor:n},className:"App ".concat("crosshair"===n?"connector-mode":""),tabIndex:1,onDoubleClick:this.handleDoubleClick,onKeyDown:this.handleKeyDown,onMouseMove:this.handleDrag,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,ref:this.handleRef},Object.values(o).map((function(e){return"sticky"===e.type?i.a.createElement(p,{cursor:n,onMouseDown:t.handleStickyMouseDown,onMouseUp:t.handleStickyMouseUp,onDragStart:t.handleWidgetDragStart,onMouseHover:t.handleMouseHoverSticky,onMouseLeave:t.handleMouseLeaveSticky,selected:!!(null===a||void 0===a?void 0:a.includes(e.id)),widget:e,key:e.id}):"arrow"===e.type?i.a.createElement(g,{widget:e,key:e.id,onDragPointStart:t.handleArrowPointDragStart}):null}))),i.a.createElement("div",{id:"settings",style:k},i.a.createElement(f,{label:"Stick To Convergent Widget Side",onCheckedChange:function(e){return t.setState({settings:{stickToConvergentWidgetSide:e}})}})))}}]),n}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))}],[[11,1,2]]]);
//# sourceMappingURL=main.8da56829.chunk.js.map